<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cat√°logo Digital ‚Äî Or√ßamento e WhatsApp</title>
  <style>
    :root {
      --accent:#d35400;
      --muted:#666;
      --card-bg:#fff;
      --page-bg:#f5f5f7;
    }
    body {
      font-family: Inter, Poppins, system-ui, Arial;
      background: var(--page-bg);
      margin:0;
      padding:20px;
      color:#222;
    }
    header {
      display:flex;
      align-items:center;
      gap:16px;
      margin-bottom:18px;
    }
    header img {
      width:56px;
      height:56px;
      border-radius:8px;
      object-fit:cover;
    }
    header h1 { font-size:26px; margin:0; }
    .layout { display:grid; grid-template-columns:1fr 380px; gap:18px; }
    .card { background:var(--card-bg); border-radius:10px; padding:12px; box-shadow:0 6px 18px rgba(0,0,0,0.06); }
    .products { display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:12px; }
    .product { display:flex; flex-direction:column; border-radius:8px; overflow:hidden; }
    .product img { width:100%; height:140px; object-fit:cover; }
    .product .body { padding:10px; flex:1; display:flex; flex-direction:column; gap:8px; }
    .product h3 { margin:0; font-size:16px; }
    .product p { margin:0; color:var(--muted); font-size:13px; }
    .prices { display:flex; gap:8px; flex-wrap:wrap; font-size:14px; }
    .prices span { background:#f1f1f1; padding:4px 8px; border-radius:6px; }
    .controls { display:flex; gap:8px; align-items:center; margin-top:6px; }
    input[type="number"] { width:80px; padding:6px; border-radius:6px; border:1px solid #ddd; }
    button { background:var(--accent); color:#fff; border:0; padding:8px 12px; border-radius:8px; cursor:pointer; }
    .cart { max-height:70vh; overflow:auto; }
    .cart-item { display:flex; gap:8px; align-items:center; border-bottom:1px dashed #eee; padding:8px 0; }
    .cart-item img { width:56px; height:40px; object-fit:cover; border-radius:6px; }
    .cart-item .info { flex:1; }
    .small { font-size:13px; color:var(--muted); }
    .total { font-weight:700; font-size:18px; margin-top:12px; text-align:right; }
    .actions { display:flex; gap:8px; justify-content:space-between; margin-top:12px; }
    .note { font-size:13px; color:var(--muted); margin-top:8px; }
    .btn-secondary { background:#2d9cdb; }
    footer { margin-top:16px; text-align:center; color:var(--muted); font-size:13px; }
    @media(max-width:900px){ .layout{grid-template-columns:1fr} }
  </style>
</head>
<body>

  <header>
    <img src="imagens/logo.jpeg" alt="Logo">
    <!--<div><img src="imagens/compras_verduras.png" alt=""></div>-->
    <div>
      
      <h1>Hortifruti Santo Ant√¥nio : Lugar de comprar barato</h1>
      
        
      
      <div class="small">Selecione os produtos, gere o or√ßamento e envie pelo WhatsApp</div>
                <!-- Bot√£o Painel Admin -->
      <a href="#" id="adminLink" style="margin-left:16px; color:#d35400; font-weight:bold;">Painel Admin</a>

    </div>
  </header>

  <div class="layout">
    <!-- PRODUTOS -->
    <div>
      <div class="card">
        <h2 style="margin:0 0 12px 0">Produtos</h2>
        <div class="products" id="productsList"></div>
      </div>
    </div>

    <!-- CARRINHO / OR√áAMENTO -->
    <aside>
      <div class="card cart">
        <h2>Or√ßamento</h2>
        <div id="cartItems"><div class="small">Nenhum item ainda.</div></div>
        <div class="total" id="cartTotal">Total: R$ 0,00</div>

        <div class="card" style="margin-top:10px">
          <h3>Seus dados</h3>
          <label>Nome:</label>
          <input type="text" id="clientName" placeholder="Seu nome" style="width:100%;margin-bottom:6px;padding:6px;border-radius:6px;border:1px solid #ccc;">
          <label>Telefone:</label>
          <input type="text" id="clientPhone" placeholder="(DDD) 9xxxx-xxxx" style="width:100%;margin-bottom:6px;padding:6px;border-radius:6px;border:1px solid #ccc;">
          <label>Endere√ßo:</label>
          <textarea id="clientAddress" placeholder="Rua, n√∫mero, bairro..." style="width:100%;margin-bottom:6px;padding:6px;border-radius:6px;border:1px solid #ccc;"></textarea>
          <label>Troco para quanto?</label>
          <input type="text" id="clientChange" placeholder="Ex: R$ 50,00" style="width:100%;padding:6px;border-radius:6px;border:1px solid #ccc;">
        </div>

        <div class="actions">
          <button id="clearBtn" class="btn-secondary">Limpar</button>
          <button id="sendWhats" style="background:#25d366">Enviar pelo WhatsApp</button>
        </div>
        <div id="pix" style="margin-top:15px;text-align:center"></div>

        <div class="note">
          <strong>Nota:</strong> Clique em "limpar" para limpar o carrinho ou "enviar" para gerar o or√ßamento e o PIX.
        </div>
      </div>
    </aside>
  </div>

  <footer>Arquivo local ‚Äî salve como <code>catalogo.html</code> e abra no navegador.</footer>

  <!-- bibliotecas primeiro -->
  

  <!-- seu c√≥digo -->
  <script>
    const sellerPhone = '5581986176915';

    // ====== Carregar produtos do localStorage ======
let products = JSON.parse(localStorage.getItem('products')) || [
  { id:'p01', name:'Laranja P√™ra', desc:'Laranja p√™ra super doce.', img:'imagens/laranja_pera.jpg', priceUnit:4.50, priceKg:28.00 },
  { id:'p02', name:'Batata Doce', desc:'Roxa doce feito mel.', img:'imagens/batata_doce.jpeg', priceUnit:null, priceKg:4.99 },
  { id:'p03', name:'Lim√£o Taiti', desc:'Lim√£o fresco e suculento.', img:'imagens/limao_taiti.jpg', priceUnit:0.89, priceKg:7.99 },
  { id:'p04', name:'Banana Prata', desc:'Banana docinha.', img:'imagens/banana_prata.jpg', priceUnit:5.90, priceKg:null },
  { id:'p05', name:'Car√°', desc:'Fresco e de √≥tima qualidade.', img:'imagens/cara.jpg', priceUnit:5.90, priceKg:null },
  { id:'p06', name:'Tomate', desc:'Tomate maduro e fresco.', img:'imagens/tomate.jpg', priceUnit:5.90, priceKg:null },
  { id:'p07', name:'Ma√ßa', desc:'Ma√ß√£ suculenta.', img:'imagens/maca.jpg', priceUnit:5.90, priceKg:null },
  { id:'p08', name:'Melancia', desc:'Melancia doce do fornecedor.', img:'imagens/melancia.jpg', priceUnit:5.90, priceKg:null },
  { id:'p09', name:'Pera', desc:'Pera fresca e docinha.', img:'imagens/pera.jpg', priceUnit:5.90, priceKg:null }
];

  localStorage.setItem('products', JSON.stringify(products));


    let cart = [];
    function formatBRL(v){ return 'R$ ' + Number(v).toFixed(2).replace('.', ','); }
    function findProduct(id){ return products.find(p => p.id === id); }

    const productsList = document.getElementById('productsList');
    function renderProducts(){
      productsList.innerHTML = '';
      products.forEach(p=>{
        const div=document.createElement('div');
        div.className='product card';
        div.innerHTML=`
          <img src="${p.img}" alt="${p.name}">
          <div class="body">
            <h3>${p.name}</h3>
            <p class="small">${p.desc}</p>
            <div class="prices">
              ${p.priceUnit?`<span>Unid: ${formatBRL(p.priceUnit)}</span>`:''}
              ${p.priceKg?`<span>Kg: ${formatBRL(p.priceKg)}</span>`:''}
            </div>
            <div class="controls">
              <label><input type="radio" name="mode_${p.id}" value="unit" ${!p.priceUnit?'disabled':'checked'}> Unid</label>
              <label><input type="radio" name="mode_${p.id}" value="kg" ${!p.priceKg?'disabled':''}> Kg</label>
              <input type="number" min="0.01" step="0.01" value="1" id="qty_${p.id}">
              <button data-id="${p.id}">Adicionar</button>
            </div>
          </div>`;
        productsList.appendChild(div);
        div.querySelector('button').addEventListener('click',()=>{
          const mode=div.querySelector(`input[name="mode_${p.id}"]:checked`)?.value;
          const qty=parseFloat(document.getElementById(`qty_${p.id}`).value);
          if(!mode||isNaN(qty)||qty<=0){alert('Escolha modo e quantidade v√°lida.');return;}
          const price=(mode==='kg')?p.priceKg:p.priceUnit;
          addToCart({productId:p.id,mode,qty,unitPrice:price});
        });
      });
    }

    function addToCart(item){
      const exist=cart.find(c=>c.productId===item.productId&&c.mode===item.mode);
      if(exist) exist.qty+=item.qty; else cart.push(item);
      renderCart();
    }
    function removeFromCart(i){cart.splice(i,1);renderCart();}
    function clearCart(){ if(confirm('Limpar carrinho?')){cart=[];renderCart();} }
    function calcTotal(){ return cart.reduce((s,it)=>s+(it.unitPrice*it.qty),0); }

    function renderCart(){
      const el=document.getElementById('cartItems');
      el.innerHTML='';
      if(cart.length===0){ el.innerHTML='<div class="small">Nenhum item ainda.</div>'; }
      else{
        cart.forEach((it,i)=>{
          const p=findProduct(it.productId);
          el.innerHTML+=`
          <div class="cart-item">
            <img src="${p.img}">
            <div class="info">
              <strong>${p.name}</strong><br>
              <span class="small">${it.qty} ${it.mode==='kg'?'kg':'un.'} √ó ${formatBRL(it.unitPrice)}</span>
            </div>
            <button style="background:#e74c3c" onclick="removeFromCart(${i})">Remover</button>
          </div>`;
        });
      }
      document.getElementById('cartTotal').textContent='Total: '+formatBRL(calcTotal());
    }

    function generateMessage(){
      const name=document.getElementById('clientName').value.trim()||'N√£o informado';
      const phone=document.getElementById('clientPhone').value.trim()||'N√£o informado';
      const addr=document.getElementById('clientAddress').value.trim()||'N√£o informado';
      const troco=document.getElementById('clientChange').value.trim()||'N√£o informado';
      const lines=['üõí *NOVO OR√áAMENTO DE CLIENTE*','','üì¶ *Itens:*',''];
      cart.forEach((it,i)=>{
        const p=findProduct(it.productId);
        const subtotal=it.unitPrice*it.qty;
        lines.push(`${i+1}. ${p.name} ‚Äî ${it.qty} ${it.mode} a ${formatBRL(it.unitPrice)} = ${formatBRL(subtotal)}`);
      });
      lines.push('',`üí∞ *Total:* ${formatBRL(calcTotal())}`,'',`üë§ *Cliente:* ${name}`,'üìû '+phone,'üè† '+addr,'üíµ Troco para: '+troco,'','üü¢ Enviado automaticamente pelo cat√°logo digital.');
      return lines.join('\n');
    }

    function gerarPix(nome,chavePix,cidade,valor,descricao){
      const payload=PixQRCode({name:nome,city:cidade,pixKey:chavePix,message:descricao,amount:valor});
      QRCode.toDataURL(payload.payload,{width:200},(err,url)=>{
        if(err)return console.error(err);
        document.getElementById('pix').innerHTML=`
          <p><b>Valor:</b> R$ ${valor.toFixed(2)}</p>
          <img src="${url}" alt="QR Code PIX">
          <p><small>C√≥digo copia e cola:</small></p>
          <textarea readonly rows="3" style="width:100%">${payload.payload}</textarea>`;
      });
    }

    function sendWhatsApp(){
      if(cart.length===0){alert('Carrinho vazio.');return;}
      const msg=generateMessage();
      const valorTotal=calcTotal();
      gerarPix("HORTIFRUTI SANTO ANT√îNIO","suachavepix@banco.com","Recife",valorTotal,"Pagamento pedido Hortifruti");
      const url=`https://wa.me/${sellerPhone}?text=${encodeURIComponent(msg)}`;
      window.open(url,'_blank');
    }

    document.getElementById('sendWhats').addEventListener('click',sendWhatsApp);
    document.getElementById('clearBtn').addEventListener('click',clearCart);
    renderProducts(); renderCart();
  </script>

  <!-- Lib para gerar QR Code -->
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<!-- Fun√ß√£o PIX simplificada (sem depender da biblioteca externa) -->
<script>
  function gerarPix(nome, chavePix, cidade, valor, descricao) {
    // Gera um payload PIX b√°sico
    const payload = `
00020126360014BR.GOV.BCB.PIX0114${chavePix}520400005303986540${valor.toFixed(2)}5802BR5913${nome.substring(0, 13)}6009${cidade.substring(0, 9)}62070503***6304
    `.replace(/\s+/g, '');

    // Gera o QR Code a partir desse payload
    QRCode.toDataURL(payload, { width: 200 }, function (err, url) {
      if (err) return console.error(err);
      
      // Mostra o QR Code na tela
      const pixDiv = document.getElementById('pix');
      pixDiv.innerHTML = `
        <p><b>Valor:</b> R$ ${valor.toFixed(2)}</p>
        <img src="${url}" alt="QR Code PIX">
        <p><small>C√≥digo copia e cola:</small></p>
        <textarea readonly rows="3" style="width:100%">${payload}</textarea>
      `;
    });
  }
</script>

 <!-- Modal de login do administrador -->
  <div id="adminLogin" style="display:none; position:fixed; top:20%; left:50%; transform:translateX(-50%); background:#fff; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.3); z-index:999;">
    <h3>Login Administrador</h3>
    <label>Senha:</label><br>
    <input type="password" id="adminPass" style="padding:6px; margin-top:6px; width:100%;"><br>
    <button id="adminSubmit" style="margin-top:10px;">Entrar</button>
    <button id="adminCancel" style="margin-top:10px; margin-left:5px; background:#ccc; color:#000;">Cancelar</button>
  </div>

  <script>
  const ADMIN_PASSWORD = "hortifruti@2026"; // Coloque aqui a sua senha de administrador

  const adminLink = document.getElementById('adminLink');
  const adminLogin = document.getElementById('adminLogin');
  const adminPassInput = document.getElementById('adminPass');
  const adminSubmit = document.getElementById('adminSubmit');
  const adminCancel = document.getElementById('adminCancel');

  // Abrir modal ao clicar no bot√£o Painel Admin
  adminLink.addEventListener('click', (e) => {
    e.preventDefault();
    adminPassInput.value = ''; // limpa o campo
    adminLogin.style.display = 'block';
    adminPassInput.focus();
  });

  // Cancelar login
  adminCancel.addEventListener('click', () => {
    adminLogin.style.display = 'none';
  });

  // Submeter senha
  adminSubmit.addEventListener('click', () => {
    const entered = adminPassInput.value;
    if(entered === ADMIN_PASSWORD){
      alert("Acesso concedido! Voc√™ pode adicionar, editar e remover produtos.");
      adminLogin.style.display = 'none';
      // Aqui voc√™ chama a fun√ß√£o para abrir o painel admin real
      openAdminPanel();
    } else {
      alert("Senha incorreta!");
      adminPassInput.value = '';
      adminPassInput.focus();
    }
  });
  // ======= Bot√µes Exportar e Importar no Painel =======
const adminPanelExtra = document.createElement('div');
adminPanelExtra.style.marginTop = '10px';
adminPanelExtra.innerHTML = `
  <button onclick="exportarProdutos()">üì§ Exportar Produtos</button>
  <input type="file" id="importFile" accept=".json" onchange="importarProdutos(this)" style="display:none;">
  <button onclick="document.getElementById('importFile').click()">üì• Importar Produtos</button>
`;
document.body.appendChild(adminPanelExtra);


  // Fun√ß√£o de exemplo para abrir o painel admin
  function openAdminPanel(){
  let action = prompt("Digite: \n1 - Adicionar produto\n2 - Editar produto\n3 - Remover produto");
  if(!action) return;

  if(action === "1"){ // Adicionar
    const id = 'p' + (products.length + 1).toString().padStart(2,'0');
    const name = prompt('Nome do produto:');
    if(!name) return;
    const desc = prompt('Descri√ß√£o:') || '';
    const priceUnit = parseFloat(prompt('Pre√ßo por unidade (ou deixe vazio)')?.replace(',','.')) || null;
    const priceKg = parseFloat(prompt('Pre√ßo por Kg (ou deixe vazio)')?.replace(',','.')) || null;
    const img = prompt('URL da imagem:') || '';
    products.push({id, name, desc, priceUnit, priceKg, img});
    localStorage.setItem('products', JSON.stringify(products));
    renderProducts();
    alert("Produto adicionado!");
  } 
  else if(action === "2"){ // Editar
    // Lista todos os produtos
    let list = "Produtos:\n";
    products.forEach((p, i) => {
      list += `${i + 1} - ${p.name} (Unid: ${p.priceUnit ?? '-'} / Kg: ${p.priceKg ?? '-'})\n`;
    });
    const idx = parseInt(prompt(list + "\nDigite o n√∫mero do produto para editar:")) - 1;
    if(idx < 0 || idx >= products.length) { alert("Produto inv√°lido!"); return; }
    const p = products[idx];
    p.name = prompt('Nome do produto:', p.name) || p.name;
    p.desc = prompt('Descri√ß√£o:', p.desc) || p.desc;
    const unit = prompt('Pre√ßo por unidade (deixe vazio para n√£o alterar):', p.priceUnit ?? '');
    p.priceUnit = unit !== '' ? parseFloat(unit.replace(',','.')) : p.priceUnit;
    const kg = prompt('Pre√ßo por Kg (deixe vazio para n√£o alterar):', p.priceKg ?? '');
    p.priceKg = kg !== '' ? parseFloat(kg.replace(',','.')) : p.priceKg;
    p.img = prompt('URL da imagem:', p.img) || p.img;
    localStorage.setItem('products', JSON.stringify(products));
    renderProducts();
    alert("Produto editado!");
  }
  else if(action === "3"){ // Remover
    // Lista todos os produtos
    let list = "Produtos:\n";
    products.forEach((p, i) => {
      list += `${i + 1} - ${p.name}\n`;
    });
    const idx = parseInt(prompt(list + "\nDigite o n√∫mero do produto para remover:")) - 1;
    if(idx < 0 || idx >= products.length) { alert("Produto inv√°lido!"); return; }
    if(confirm(`Deseja realmente remover ${products[idx].name}?`)){
      products.splice(idx,1);
      localStorage.setItem('products', JSON.stringify(products));
      renderProducts();
      alert("Produto removido!");
    }
  }
  else{
    alert("Op√ß√£o inv√°lida!");
  }
}

// ======= Exportar produtos =======
function exportarProdutos() {
  const products = JSON.parse(localStorage.getItem('products')) || [];
  const blob = new Blob([JSON.stringify(products, null, 2)], { type: "application/json" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = 'produtos.json';
  a.click();
  URL.revokeObjectURL(url);

  alert("‚úÖ Produtos exportados com sucesso! O arquivo produtos.json foi baixado.");
}

// ======= Importar produtos =======
function importarProdutos(input) {
  const file = input.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function (e) {
    try {
      const importedProducts = JSON.parse(e.target.result);
      localStorage.setItem('products', JSON.stringify(importedProducts));
      alert("‚úÖ Produtos importados com sucesso!");
      location.reload();
    } catch (error) {
      alert("‚ùå Erro ao importar arquivo. Verifique se √© um .json v√°lido.");
    }
  };
  reader.readAsText(file);
}


</script>


</body>
</html>
